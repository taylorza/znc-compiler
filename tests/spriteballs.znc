make dot "spriteballs.dot";

include "io.znc"
include "rnd.znc"
include "sprite.znc"

byte[] p = {
    0xe3, 0xe3, 0xe3, 0xe3, 0xe3, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0xe3, 0xe3, 0xe3, 0xe3, 0xe3,
		0xe3, 0xe3, 0xe3, 0x60, 0x60, 0x80, 0x60, 0x80, 0x80, 0x80, 0x80, 0x60, 0x60, 0xe3, 0xe3, 0xe3,
		0xe3, 0xe3, 0x60, 0x80, 0xa0, 0x60, 0xa0, 0xa0, 0xa0, 0xa0, 0xa0, 0x60, 0x80, 0x60, 0xe3, 0xe3,
		0xe3, 0x60, 0x80, 0xa0, 0xa0, 0x60, 0xa0, 0xa0, 0xa0, 0xa0, 0x60, 0xa0, 0x80, 0x80, 0x60, 0xe3,
		0xe3, 0x60, 0x60, 0xa0, 0xa0, 0x60, 0xa0, 0xa0, 0xa0, 0x60, 0xa0, 0xa0, 0xa0, 0x80, 0x60, 0xe3,
		0x60, 0x80, 0x60, 0x60, 0xa0, 0x80, 0xa0, 0xa0, 0x60, 0xa0, 0xa0, 0xa0, 0xa0, 0x80, 0x80, 0x60,
		0x60, 0x80, 0xa0, 0xa0, 0x80, 0xa0, 0x80, 0x60, 0xa0, 0xa0, 0xa0, 0xa0, 0xa0, 0x80, 0x80, 0x60,
		0x60, 0x80, 0xa0, 0xa0, 0xa0, 0x80, 0xa0, 0xa0, 0xa0, 0xa0, 0xa0, 0xa0, 0xa0, 0x80, 0x80, 0x60,
		0x60, 0x80, 0xa0, 0xa0, 0xa0, 0x60, 0xa0, 0xa0, 0xa0, 0xa0, 0xa0, 0xa0, 0xa0, 0x80, 0x60, 0x60,
		0x60, 0x60, 0xa0, 0xa0, 0x60, 0xa0, 0xa0, 0xa0, 0xa0, 0xa0, 0xa0, 0xa0, 0xa0, 0x60, 0x80, 0x60,
		0x60, 0x80, 0x60, 0xa0, 0x60, 0xa0, 0xa0, 0xa0, 0xa0, 0xa0, 0x60, 0x60, 0x60, 0x80, 0x80, 0x60,
		0xe3, 0x60, 0x80, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0xa0, 0x80, 0x80, 0x80, 0x60, 0xe3,
		0xe3, 0x60, 0x80, 0x80, 0xa0, 0x60, 0xa0, 0xa0, 0xa0, 0xa0, 0xa0, 0x80, 0x80, 0x80, 0x60, 0xe3,
		0xe3, 0xe3, 0x60, 0x80, 0x80, 0x60, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x60, 0xe3, 0xe3,
		0xe3, 0xe3, 0xe3, 0x60, 0x60, 0x80, 0x60, 0x80, 0x80, 0x80, 0x80, 0x60, 0x60, 0xe3, 0xe3, 0xe3,
		0xe3, 0xe3, 0xe3, 0xe3, 0xe3, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0xe3, 0xe3, 0xe3, 0xe3, 0xe3,
};

spr_load(0, p, 16*16); 
spr_enable();

int[64] x;
int[64] y;
int[64] dx;
int[64] dy;

for (int i=0;i<64;i=i+1) {
  x[i]=35+(rnd()%100);
  y[i]=35+(rnd()%100);
  dx[i]=1+(rnd()%2);
  dy[i]=1+(rnd()%2);  
}

for(;;) {
  for(int i=0;i<64;i=i+1) {
    x[i]=x[i]+dx[i];
    y[i]=y[i]+dy[i];
    if (x[i]<=32 || x[i]>=(240-16)) dx[i]=-dx[i];
    if (y[i]<=32 || y[i]>=(186-16)) dy[i]=-dy[i];
  }
  __asm__{
    ;halt
  }
  
  for(int i=0;i<64;i=i+1) {
    spr_update(i,0,x[i],y[i],0);
  }
  
  if ((in(0x7ffe) & 0x01) == 0) break;
}
spr_disable();
